# Serialization

# Сериализация и работа с файлами


## Задача 1 (обязательная)

:warning: Эта задача является продолжением [задачи про одномерные массивы](./ARR1D.md), поэтому для выполнения этой лучше сперва нужно получить по ней зачёт.

Возьмите реплит с решением [задачи про магазин](./ARR1D.md) или решите её заново сразу в соответствии с новыми требованиями.
Несмотря на то, что та задача решалась в реплите, эти мы сдаём через гитхаб.
Требования исходного условия задания сохраняются и в этой задаче.

Создайте класс `Basket`, объект которого будет представлять себе покупательскую корзину. В нём должны быть методы:
* конструктор, принимающий массив цен и названий продуктов;
* `addToCart(int productNum, int amount)` - метод добавления `amount` штук продукта номер `productNum` в корзину;
* `printCart()` - метод вывода на экран покупательской корзины.
* `saveTxt(File textFile)` - метод сохранения корзины в текстовый файл; использовать встроенные сериализаторы нельзя;
* `static Basket loadFromTxtFile(File textFile)` - статический(!) метод восстановления объекта корзины из текстового файла, в который ранее была она сохранена;
* геттеры, которые вы посчитаете нужными.

После ввода каждой покупки пользователем вам следует сохранять пользовательскую корзину в файл `basket.txt`. 
При старте программа должна искать этот файл в корне проекта и если он находится, восстанавливать корзину из него; если файл не найдет, то стоит начать с пустой корзины.

Коммит и пуш в ветку `main`.

### Подсказки
Если все данные у вас хранятся в массивах, то просто сохраните по массиву на каждой строке.

Например, если бы это был лонговый массив в поле нашей корзины, то можно было бы сделать так:
```java
public void saveTxt(File textFile) throws IOException {
    try (PrintWriter out = new PrintWriter(file);) {
        ...
        for (long e : longArrInField)    
            out.print(e + " ");
        }
        ...
    }
}
```

А при чтении вы сможете строку файла разбить через `split(" ")` и пройдясь циклом каждое значение превратить в `long`.

## Задача 2 (обязательная)

Эту задачу делаем в том же репозитории. Отведите ветку `serial` от `main`, в которой находится решение первой задачи.

В этом задании мы будем сохранять и восстанавливать корзину покупок через встроенную сериализацию в Java.

Добавьте метод `saveBin(File file)` для сохранения в файл в бинарном формате.

Добавьте метод `static loadFromBinFile(File file)` для загрузки корзины из бинарного файла.

Используйте для этого сериализацию и десериализацию.
Замените в `main` сохранение и загрузку из текстового файла на бинарный (название пусть будет `basket.bin`).

Коммит и пуш в ветку `serial`.


# XML, JSON, CSV


## Задача 1 (обязательная)

:warning: Эта задача является продолжением [задачи про сериализацию](./SERIAL.md), поэтому для выполнения этой лучше сперва нужно получить по ней зачёт.

Возьмите репо с решением [задачи про сериализацию](./SERIAL.md) и отведите новую ветку `json` от `main`.

Создайте класс `ClientLog` для сохранения всех операций, которые ввёл пользователь.
Т.е. покупатель добавил покупку, то это действие должно быть там сохранено. Для этого создайте там метод `log(int productNum, int amount)`.
Также у объекта этого класса должен быть метод `exportAsCSV(File txtFile)` для сохранения всего журнала действия в файл в формате csv.
Пример файла который должен получиться:
```csv
productNum,amount
3,4
1,1
3,2
5,12
```

В конце работы программы сохраняйте журнал действий в файл `log.csv`.

Также вместо вызова метода `saveTxt` в методе `main` сериализуйте корзину в json-формате в файл `basket.json`.
Аналогично при старте программы загружайте корзину десериализацией из json-а из файла `basket.json`, а не из обычной текстовой сериализации как было до того.
При этом логику сериализации в методах в классе корзины трогать не нужно.

Коммит и пуш в ветку `json`.

## Задача 2 (обязательная)

Эту задачу делайте в том же репозитории и ветке, что и первую.

В корне вашего проекта разместите: `shop.xml` с содержимым:
```xml
<config>
  <load>
    <enabled>false</enabled>
    <fileName>basket.json</fileName>
    <format>json</format>
  </load>
  
  <save>
    <enabled>true</enabled>
    <fileName>basket.json</fileName>
    <format>json</format>
  </save>
  
  <log>
    <enabled>true</enabled>
    <fileName>client.csv</fileName>
  </log>
</config>
```

При старте ваша программа должна считывать этот файл и загружать из него настройки:
* блок `load` говорит нужно ли загружать данные корзины при старте программы из файла (`enabled`), указывает имя этого файла (`fileName`) и формат (`json` или `text`). Ваша программа должна вести себя соответствующим образом.
* блок `save` говорит нужно ли сохранять данные корзины после каждого ввода, куда и в каком формате (`text` или `json`).
* блок `log` говорит нужно ли сохранять лог при завершении программы и в какой файл; формат лога всегда csv.

Сделайте коммит и пуш в ветку `json`.
